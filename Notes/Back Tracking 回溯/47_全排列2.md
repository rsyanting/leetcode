# 47 : å…¨æ’åˆ—2

## ğŸ“Œé¢˜ç›®è¯¦æƒ…

[leetcode-cn é¢˜ç›®åœ°å€](https://leetcode-cn.com/problems/permutations/)

ğŸ“—Difficultyï¼š**Medium** 

ğŸ¯Tagsï¼š

+ [å›æº¯](https://leetcode-cn.com/tag/backtracking/)

---

## ğŸ“ƒé¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ª **å¯åŒ…å«é‡å¤æ•°å­—** çš„åºåˆ—ï¼Œè¿”å›æ‰€æœ‰ **ä¸é‡å¤** çš„ **å…¨æ’åˆ—**ã€‚



**æ ·ä¾‹ 1ï¼š**

```
è¾“å…¥: [1,1,2]
è¾“å‡º:
[
  [1,1,2],
  [1,2,1],
  [2,1,1]
]
```



****

## ğŸ¹ğŸ¯è§£é¢˜æ€è·¯

è¿™ä¸€é¢˜åœ¨ã€ŒåŠ›æ‰£ã€ç¬¬ 46 é¢˜ï¼š [å…¨æ’åˆ—](https://leetcode-cn.com/problems/permutations/) çš„åŸºç¡€ä¸Šå¢åŠ äº† **åºåˆ—ä¸­çš„å…ƒç´ å¯é‡å¤** è¿™ä¸€æ¡ä»¶ï¼Œä½†è¦æ±‚ï¼šè¿”å›çš„ç»“æœåˆä¸èƒ½æœ‰é‡å¤å…ƒç´ ã€‚

æ€è·¯æ˜¯ï¼šåœ¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œä¸€è¾¹éå†ä¸€éæ£€æµ‹ï¼Œåœ¨ä¸€å®šä¼šäº§ç”Ÿé‡å¤ç»“æœé›†çš„åœ°æ–¹å‰ªæã€‚



ä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„åŠæ³•æ˜¯åœ¨ç»“æœé›†ä¸­å»é‡ã€‚ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œè¿™äº›ç»“æœé›†çš„å…ƒç´ æ˜¯ä¸€ä¸ªåˆä¸€ä¸ªåˆ—è¡¨ï¼Œå¯¹åˆ—è¡¨å»é‡ä¸åƒç”¨å“ˆå¸Œè¡¨å¯¹åŸºæœ¬å…ƒç´ å»é‡é‚£æ ·å®¹æ˜“ã€‚

å¦‚æœè¦æ¯”è¾ƒä¸¤ä¸ªåˆ—è¡¨æ˜¯å¦ä¸€æ ·ï¼Œä¸€ä¸ªå®¹æ˜“æƒ³åˆ°çš„åŠæ³•æ˜¯å¯¹åˆ—è¡¨åˆ†åˆ«æ’åºï¼Œç„¶åé€ä¸ªæ¯”å¯¹ã€‚æ—¢ç„¶è¦æ’åºï¼Œæˆ‘ä»¬å°±å¯ä»¥ åœ¨æœç´¢ä¹‹å‰å°±å¯¹å€™é€‰æ•°ç»„æ’åºï¼Œä¸€æ—¦å‘ç°æŸä¸ªåˆ†æ”¯æœç´¢ä¸‹å»å¯èƒ½æœç´¢åˆ°é‡å¤çš„å…ƒç´ å°±åœæ­¢æœç´¢ï¼Œè¿™æ ·ç»“æœé›†ä¸­ä¸ä¼šåŒ…å«é‡å¤åˆ—è¡¨ã€‚

ç”»å‡ºæ ‘å½¢ç»“æ„å¦‚ä¸‹ï¼šé‡ç‚¹æƒ³è±¡æ·±åº¦ä¼˜å…ˆéå†åœ¨è¿™æ£µæ ‘ä¸Šæ‰§è¡Œçš„è¿‡ç¨‹ï¼Œå“ªäº›åœ°æ–¹éå†ä¸‹å»ä¸€å®šä¼šäº§ç”Ÿé‡å¤ï¼Œè¿™äº›åœ°æ–¹çš„çŠ¶æ€çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ

å¯¹æ¯”å›¾ä¸­æ ‡æ³¨ â‘  å’Œ â‘¡ çš„åœ°æ–¹ã€‚ç›¸åŒç‚¹æ˜¯ï¼šè¿™ä¸€æ¬¡æœç´¢çš„èµ·ç‚¹å’Œä¸Šä¸€æ¬¡æœç´¢çš„èµ·ç‚¹ä¸€æ ·ã€‚ä¸åŒç‚¹æ˜¯ï¼š



![é€’å½’æ ‘å›¾ç¤º](https://assets.ryantech.ltd/20201018204635.png)





#### ä»£ç å®ç°

```java
// DFS å‰ªæ
public List<List<Integer>> permuteUnique(int[] nums) {
    List<List<Integer>> res = new ArrayList<>();

    if (nums == null || nums.length == 0) {
        return res;
    }

    Arrays.sort(nums); // é¦–å…ˆè¿›è¡Œæ’åºï¼Œä¸ºäº†å‰ªæ

    Deque<Integer> path = new ArrayDeque<>();
    int len = nums.length;
    boolean[] used = new boolean[len];
    dfs(nums, len, 0, used, path, res);

    return res;
}

private void dfs(int[] nums, int len, int depth, boolean[] used, Deque<Integer> path, List<List<Integer>> res) {
    if (depth == len) {
        res.add(new ArrayList<>(path));
        return;
    }

    // å…¨æ’åˆ—ä» 0 å¼€å§‹æŸ¥æ‰¾
    for (int i = 0; i < len; i++) {
        if (used[i]) {
            continue;
        }

        // å‰ªææ¡ä»¶
        // used[i - 1] æ˜¯å› ä¸º nums[i - 1] åœ¨å›é€€è¿‡ç¨‹ä¸­åˆšåˆšè¢«æ’¤é”€äº†é€‰æ‹©ï¼Œè¿™é‡Œå¾ˆé‡è¦
        if (i > 0 && nums[i] == nums[i - 1] && !used[i - 1]) {
            continue;
        }

        path.addLast(nums[i]);
        used[i] = true;
        dfs(nums, len, depth + 1, used, path, res);

        path.removeLast();
        used[i] = false;
    }
}
```



#### å¤æ‚åº¦åˆ†æ

+ æ—¶é—´å¤æ‚åº¦ï¼š`O(n * n!)` ã€‚
+ ç©ºé—´å¤æ‚åº¦ï¼š`O(n)` ã€‚



---

## ğŸ’¡æ€»ç»“

#### [46. å…¨æ’åˆ—](https://leetcode-cn.com/problems/permutations/) 

```java
public List<List<Integer>> permute(int[] nums) {
    List<List<Integer>> res = new ArrayList<>();

    // ç‰¹åˆ¤
    if (nums == null || nums.length == 0) {
        return res;
    }

    int len = nums.length;

    Deque<Integer> path = new ArrayDeque<>(); // å›æº¯æ ˆ
    boolean[] used = new boolean[len]; // é»˜è®¤æ‰€æœ‰çš„å…ƒç´ éƒ½æ²¡æœ‰è¢«ä½¿ç”¨è¿‡
    // depth ä¸ºå½“å‰çš„æ·±åº¦ï¼Œæœ€å¤§æ·±åº¦ä¸º len å¤§å°
    // ä»ç¬¬ 0 ä¸ªå…ƒç´ å¼€å§‹
    dfs(nums, len, 0, path, used, res);

    return res;
}

private void dfs(int[] nums, int len, int depth, Deque<Integer> path, boolean[] used, List<List<Integer>> res) {
    // é€’å½’ç»“æŸçš„æ¡ä»¶
    if (depth == len) {
        res.add(new ArrayList<>(path)); // æ³¨æ„ï¼Œè¿™é‡Œç”Ÿæˆä¸€ä¸ªæ–°çš„æ‹·è´
        return;
    }

    // å°è¯•éå†æ¯ä¸€ä¸ªå…ƒç´ 
    for (int i = 0; i < len; i++) {
        if (used[i]) {
            continue; // å¦‚æœè¢«ä½¿ç”¨äº†ï¼Œé‚£ä¹ˆè·³è¿‡
        }

        path.addLast(nums[i]); // æ·»åŠ å…ƒç´ åˆ°å½“å‰ pathï¼Œå³é€‰æ‹©å½“å‰çš„ nums[i]
        used[i] = true; // æ ‡è®°å·²ç»é€‰æ‹©äº†è¯¥ nums[i]
        dfs(nums, len, depth + 1, path, used, res); // å°è¯•å¯»æ‰¾ä¸‹ä¸€ä¸ªå…ƒç´  depth + 1
        // å›æº¯
        path.removeLast(); // ç§»é™¤æœ€åä¸€ä¸ªé€‰æ‹©çš„å…ƒç´ ï¼Œè¿›è¡Œå›æº¯
        used[i] = false; // æ ‡è®°è¯¥å…ƒç´ æœªè¢«ä½¿ç”¨
    }
}
```

