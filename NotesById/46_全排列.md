# 46 : å…¨æ’åˆ—

## ğŸ“Œé¢˜ç›®è¯¦æƒ…

[leetcode-cn é¢˜ç›®åœ°å€](https://leetcode-cn.com/problems/permutations/)

ğŸ“—Difficultyï¼š**Medium** 

ğŸ¯Tagsï¼š

+ [å›æº¯](https://leetcode-cn.com/tag/backtracking/)

---

## ğŸ“ƒé¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ª **æ²¡æœ‰é‡å¤** æ•°å­—çš„åºåˆ—ï¼Œè¿”å›å…¶æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—ã€‚



**æ ·ä¾‹ 1ï¼š**

```
è¾“å…¥: [1,2,3]
è¾“å‡º:
[
  [1,2,3],
  [1,3,2],
  [2,1,3],
  [2,3,1],
  [3,1,2],
  [3,2,1]
]
```



****

## ğŸ¹ğŸ¯è§£é¢˜æ€è·¯

> [Leetcode å®˜æ–¹é¢˜è§£](https://leetcode-cn.com/problems/permutations/solution/quan-pai-lie-by-leetcode-solution-2/)

> [å›æº¯ç®—æ³•å…¥é—¨çº§è¯¦è§£ + ç»ƒä¹ ï¼ˆæŒç»­æ›´æ–°ï¼‰](https://leetcode-cn.com/problems/permutations/solution/hui-su-suan-fa-python-dai-ma-java-dai-ma-by-liweiw/)

### ä»å…¨æ’åˆ—é—®é¢˜å¼€å§‹ç†è§£å›æº¯ç®—æ³•

æˆ‘ä»¬å°è¯•åœ¨çº¸ä¸Šå†™ 3 ä¸ªæ•°å­—ã€4 ä¸ªæ•°å­—ã€5 ä¸ªæ•°å­—çš„å…¨æ’åˆ—ï¼Œç›¸ä¿¡ä¸éš¾æ‰¾åˆ°è¿™æ ·çš„æ–¹æ³•ã€‚ä»¥æ•°ç»„ `[1, 2, 3]` çš„å…¨æ’åˆ—ä¸ºä¾‹ã€‚

+ å…ˆå†™ä»¥ `1` å¼€å¤´çš„å…¨æ’åˆ—ï¼Œå®ƒä»¬æ˜¯ï¼š`[1, 2, 3]`, `[1, 3, 2]`ï¼Œå³ `1 + [2, 3]` çš„å…¨æ’åˆ—ï¼ˆ**æ³¨æ„ï¼šé€’å½’ç»“æ„ä½“ç°åœ¨è¿™é‡Œ**ï¼‰ï¼›
+ å†å†™ä»¥ `2` å¼€å¤´çš„å…¨æ’åˆ—ï¼Œå®ƒä»¬æ˜¯ï¼š`[2, 1, 3]`, `[2, 3, 1]`ï¼Œå³ `2 + [1, 3]` çš„å…¨æ’åˆ—ï¼›
+ æœ€åå†™ä»¥ `3` å¼€å¤´çš„å…¨æ’åˆ—ï¼Œå®ƒä»¬æ˜¯ï¼š`[3, 1, 2]`, `[3, 2, 1]`ï¼Œå³ `3 + [1, 2]` çš„å…¨æ’åˆ—ã€‚

æ€»ç»“æœç´¢çš„æ–¹æ³•ï¼šæŒ‰é¡ºåºæšä¸¾æ¯ä¸€ä½å¯èƒ½å‡ºç°çš„æƒ…å†µï¼Œå·²ç»é€‰æ‹©çš„æ•°å­—åœ¨ **å½“å‰** è¦é€‰æ‹©çš„æ•°å­—ä¸­ä¸èƒ½å‡ºç°ã€‚æŒ‰ç…§è¿™ç§ç­–ç•¥æœç´¢å°±èƒ½å¤Ÿåšåˆ° **ä¸é‡ä¸æ¼**ã€‚è¿™æ ·çš„æ€è·¯ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªæ ‘å½¢ç»“æ„è¡¨ç¤ºã€‚

![å›¾ç¤º](https://assets.ryantech.ltd/20201017195950.png)

**è¯´æ˜ï¼š**

+ **æ¯ä¸€ä¸ªç»“ç‚¹è¡¨ç¤ºäº†æ±‚è§£å…¨æ’åˆ—é—®é¢˜çš„ä¸åŒçš„é˜¶æ®µ**ï¼Œè¿™äº›é˜¶æ®µé€šè¿‡å˜é‡çš„ã€Œä¸åŒçš„å€¼ã€ä½“ç°ï¼Œè¿™äº›å˜é‡çš„ä¸åŒçš„å€¼ï¼Œç§°ä¹‹ä¸ºã€ŒçŠ¶æ€ã€ï¼›
+ ä½¿ç”¨æ·±åº¦ä¼˜å…ˆéå†æœ‰ã€Œå›å¤´ã€çš„è¿‡ç¨‹ï¼Œåœ¨ã€Œå›å¤´ã€ä»¥åï¼Œ **çŠ¶æ€å˜é‡éœ€è¦è®¾ç½®æˆä¸ºå’Œå…ˆå‰ä¸€æ ·** ï¼Œå› æ­¤åœ¨å›åˆ°ä¸Šä¸€å±‚ç»“ç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ’¤é”€ä¸Šä¸€æ¬¡çš„é€‰æ‹©ï¼Œè¿™ä¸ªæ“ä½œç§°ä¹‹ä¸º**ã€ŒçŠ¶æ€é‡ç½®ã€**ï¼›
+ æ·±åº¦ä¼˜å…ˆéå†ï¼Œå€ŸåŠ©ç³»ç»Ÿæ ˆç©ºé—´ï¼Œä¿å­˜æ‰€éœ€è¦çš„çŠ¶æ€å˜é‡ï¼Œåœ¨ç¼–ç ä¸­åªéœ€è¦æ³¨æ„éå†åˆ°ç›¸åº”çš„ç»“ç‚¹çš„æ—¶å€™ï¼ŒçŠ¶æ€å˜é‡çš„å€¼æ˜¯æ­£ç¡®çš„ï¼Œå…·ä½“çš„åšæ³•æ˜¯ï¼šå¾€ä¸‹èµ°ä¸€å±‚çš„æ—¶å€™ï¼Œ`path` å˜é‡åœ¨å°¾éƒ¨è¿½åŠ ï¼Œè€Œå¾€å›èµ°çš„æ—¶å€™ï¼Œéœ€è¦æ’¤é”€ä¸Šä¸€æ¬¡çš„é€‰æ‹©ï¼Œä¹Ÿæ˜¯åœ¨å°¾éƒ¨æ“ä½œï¼Œå› æ­¤ `path` å˜é‡æ˜¯ä¸€ä¸ªæ ˆï¼›
+ æ·±åº¦ä¼˜å…ˆéå†é€šè¿‡ã€Œå›æº¯ã€æ“ä½œï¼Œå®ç°äº†å…¨å±€ä½¿ç”¨ä¸€ä»½çŠ¶æ€å˜é‡çš„æ•ˆæœã€‚

ä½¿ç”¨ç¼–ç¨‹çš„æ–¹æ³•å¾—åˆ°å…¨æ’åˆ—ï¼Œå°±æ˜¯åœ¨è¿™æ ·çš„ä¸€ä¸ªæ ‘å½¢ç»“æ„ä¸­å®Œæˆ éå†ï¼Œä»æ ‘çš„æ ¹ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹å½¢æˆçš„è·¯å¾„å°±æ˜¯å…¶ä¸­ä¸€ä¸ªå…¨æ’åˆ—ã€‚

#### è®¾è®¡çŠ¶æ€å˜é‡

+ é¦–å…ˆè¿™æ£µæ ‘é™¤äº†æ ¹ç»“ç‚¹å’Œå¶å­ç»“ç‚¹ä»¥å¤–ï¼Œæ¯ä¸€ä¸ªç»“ç‚¹åšçš„äº‹æƒ…å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œå³ï¼šåœ¨å·²ç»é€‰æ‹©äº†ä¸€äº›æ•°çš„å‰æä¸‹ï¼Œåœ¨å‰©ä¸‹çš„è¿˜æ²¡æœ‰é€‰æ‹©çš„æ•°ä¸­ï¼Œä¾æ¬¡é€‰æ‹©ä¸€ä¸ªæ•°ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ª **é€’å½’** ç»“æ„ï¼›
+ é€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯ï¼š **ä¸€ä¸ªæ’åˆ—ä¸­çš„æ•°å­—å·²ç»é€‰å¤Ÿäº†** ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå˜é‡æ¥è¡¨ç¤ºå½“å‰ç¨‹åºé€’å½’åˆ°ç¬¬å‡ å±‚ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªå˜é‡å«åš `depth`ï¼Œæˆ–è€…å‘½åä¸º `index` ï¼Œè¡¨ç¤ºå½“å‰è¦ç¡®å®šçš„æ˜¯æŸä¸ªå…¨æ’åˆ—ä¸­ä¸‹æ ‡ä¸º `index` çš„é‚£ä¸ªæ•°æ˜¯å¤šå°‘ï¼›
+ å¸ƒå°”æ•°ç»„ `used`ï¼Œåˆå§‹åŒ–çš„æ—¶å€™éƒ½ä¸º `false` è¡¨ç¤ºè¿™äº›æ•°è¿˜æ²¡æœ‰è¢«é€‰æ‹©ï¼Œå½“æˆ‘ä»¬é€‰å®šä¸€ä¸ªæ•°çš„æ—¶å€™ï¼Œå°±å°†è¿™ä¸ªæ•°ç»„çš„ç›¸åº”ä½ç½®è®¾ç½®ä¸º `true` ï¼Œè¿™æ ·åœ¨è€ƒè™‘ä¸‹ä¸€ä¸ªä½ç½®çš„æ—¶å€™ï¼Œå°±èƒ½å¤Ÿä»¥ `O(1)` çš„æ—¶é—´å¤æ‚åº¦åˆ¤æ–­è¿™ä¸ªæ•°æ˜¯å¦è¢«é€‰æ‹©è¿‡ï¼Œè¿™æ˜¯ä¸€ç§ã€Œä»¥ç©ºé—´æ¢æ—¶é—´ã€çš„æ€æƒ³ã€‚

è¿™äº›å˜é‡ç§°ä¸ºã€ŒçŠ¶æ€å˜é‡ã€ï¼Œå®ƒä»¬è¡¨ç¤ºäº†åœ¨æ±‚è§£ä¸€ä¸ªé—®é¢˜çš„æ—¶å€™æ‰€å¤„çš„é˜¶æ®µã€‚éœ€è¦æ ¹æ®é—®é¢˜çš„åœºæ™¯è®¾è®¡åˆé€‚çš„çŠ¶æ€å˜é‡ã€‚



#### ä»£ç å®ç°

```java
public List<List<Integer>> permute(int[] nums) {
    List<List<Integer>> res = new ArrayList<>();

    // ç‰¹åˆ¤
    if (nums == null || nums.length == 0) {
        return res;
    }

    int len = nums.length;

    Deque<Integer> path = new ArrayDeque<>(); // å›æº¯æ ˆ
    boolean[] used = new boolean[len]; // é»˜è®¤æ‰€æœ‰çš„å…ƒç´ éƒ½æ²¡æœ‰è¢«ä½¿ç”¨è¿‡
    // depth ä¸ºå½“å‰çš„æ·±åº¦ï¼Œæœ€å¤§æ·±åº¦ä¸º len å¤§å°
    // ä»ç¬¬ 0 ä¸ªå…ƒç´ å¼€å§‹
    dfs(nums, len, 0, path, used, res);

    return res;
}

private void dfs(int[] nums, int len, int depth, Deque<Integer> path, boolean[] used, List<List<Integer>> res) {
    // é€’å½’ç»“æŸçš„æ¡ä»¶
    if (depth == len) {
        res.add(new ArrayList<>(path)); // æ³¨æ„ï¼Œè¿™é‡Œç”Ÿæˆä¸€ä¸ªæ–°çš„æ‹·è´
        return;
    }

    // å°è¯•éå†æ¯ä¸€ä¸ªå…ƒç´ 
    for (int i = 0; i < len; i++) {
        if (used[i]) {
            continue; // å¦‚æœè¢«ä½¿ç”¨äº†ï¼Œé‚£ä¹ˆè·³è¿‡
        }

        path.addLast(nums[i]); // æ·»åŠ å…ƒç´ åˆ°å½“å‰ pathï¼Œå³é€‰æ‹©å½“å‰çš„ nums[i]
        used[i] = true; // æ ‡è®°å·²ç»é€‰æ‹©äº†è¯¥ nums[i]
        dfs(nums, len, depth + 1, path, used, res); // å°è¯•å¯»æ‰¾ä¸‹ä¸€ä¸ªå…ƒç´  depth + 1
        // å›æº¯
        path.removeLast(); // ç§»é™¤æœ€åä¸€ä¸ªé€‰æ‹©çš„å…ƒç´ ï¼Œè¿›è¡Œå›æº¯
        used[i] = false; // æ ‡è®°è¯¥å…ƒç´ æœªè¢«ä½¿ç”¨
    }
}
```



#### å¤æ‚åº¦åˆ†æ

+ æ—¶é—´å¤æ‚åº¦ï¼š`O(n * n!)` ã€‚
+ ç©ºé—´å¤æ‚åº¦ï¼š`O(n * n!)` ã€‚

![å¤æ‚åº¦åˆ†æ](https://assets.ryantech.ltd/20201017194846.png)



---

## ğŸ’¡æ€»ç»“

### ç›¸ä¼¼é¢˜ç›®

#### æ‹›å•†é“¶è¡Œ é¢è¯•é¢˜

ç»™å®šä¸€ä¸ªæ•°ç»„ `nums = {1,2,3,4}` ï¼Œè¯·é€‰æ‹© `3` ä¸ªæ•°å­—ï¼Œç»„æˆ `1` ä¸ªä¸‰ä½çš„æ•°å­—ï¼Œæ‰¾å‡ºå…¨éƒ¨çš„ç»„åˆï¼Œå¹¶æ’é™¤é‡å¤çš„æ•°å­—ã€‚

é‚£ä¹ˆæŠ›å¼€ä¸Šé¢çš„æ¡ä»¶ï¼Œå¯ä»¥å¯¹é¢˜ç›®è¿›è¡Œä¸€å®šçš„å»¶å±•ï¼šç»™å®šä¸€ä¸ªæ•°ç»„ `nums` ï¼Œç»™å®šä¸€ä¸ªæ•°å­— `k` ï¼Œä» `nums` ä¸­é€‰æ‹© `k` ä¸ªå…ƒç´ ï¼Œæ’åˆ—æˆä¸€ä¸ªä¸‰ä½æ•°ã€‚



ç±»ä¼¼äºä¸Šé¢çš„ [46. å…¨æ’åˆ—](https://leetcode-cn.com/problems/permutations/) ï¼Œè¿™é‡Œçš„æ¡ä»¶æœ‰ä¸€äº›å˜æ›´ï¼Œå˜æˆäº†éå…¨æ’åˆ—çš„æƒ…å†µã€‚

å‚è€ƒä¸Šé¢ [46. å…¨æ’åˆ—](https://leetcode-cn.com/problems/permutations/) çš„ä»£ç ï¼Œæœ‰ä¸€äº›å˜åŠ¨çš„åœ°æ–¹åœ¨äºï¼Œ`dfs` çš„ç»ˆæ­¢æ¡ä»¶æœ‰å˜åŒ–ï¼Œå½“ `path.size() == k` æ—¶ï¼Œå°±è¯´æ˜å¯»æ‰¾åˆ°äº†ä¸€ä¸ªç¬¦åˆçš„è§£ã€‚



```java
public class cmbApp {
    // æ‹›å•†é“¶è¡Œ ç¬”è¯•é¢˜
    // æ’åˆ—ï¼Œéå…¨æ’åˆ—
    // ç»™å®š [1,2,3,4] é€‰å‡º 3 ä¸ªæ•°å­—ï¼Œæ±‚è§£å‡ºå…¨éƒ¨çš„ä¸”ä¸ç›¸ç­‰çš„ä¸‰ä½æ•°å­—ï¼Œä¾‹å¦‚ 123 132 213 ...
    public List<List<Integer>> getThreeNums(int[] nums, int k) {
        List<List<Integer>> res = new ArrayList<>();

        if (nums == null || nums.length == 0) {
            return res;
        }

        int len = nums.length;

        Deque<Integer> path = new ArrayDeque<>();
        boolean[] used = new boolean[len]; // æ ‡è®°è¯¥å…ƒç´ æ˜¯å¦è¢«ä½¿ç”¨äº†
        dfs(nums, k, 0, path, used, res); // åˆå§‹ dfs çš„ depth = 0

        return res;
    }

    private void dfs(int[] nums, int len, int depth, Deque<Integer> path, boolean[] used, List<List<Integer>> res) {
        // dfs ç»ˆæ­¢çš„æ¡ä»¶
        // å½“ path ä¸­çš„æ•°å­—æ•°é‡å’Œ len ç›¸ç­‰æ—¶ï¼Œè¯´æ˜å¯»æ‰¾åˆ°äº†ä¸€ç»„è¿™æ ·çš„æ•°æ®
        if (path.size() == len) {
            res.add(new ArrayList<>(path)); // æ³¨æ„ï¼Œè¿™é‡Œç”Ÿæˆä¸€ä¸ªæ–°çš„æ‹·è´
            return;
        }

        // å°è¯•éå†æ¯ä¸€ä¸ªå…ƒç´ 
        for (int i = 0; i < nums.length; i++) {
            if (used[i]) {
                continue; // å¦‚æœè¢«ä½¿ç”¨è¿‡äº†ï¼Œé‚£ä¹ˆè·³è¿‡
            }

            path.addLast(nums[i]); // æ·»åŠ å½“å‰çš„å…ƒç´ åˆ° path æ ˆä¸­å»
            used[i] = true; // æ ‡è®°å½“å‰å…ƒç´ è¢«ä½¿ç”¨äº†
            dfs(nums, len, depth + 1, path, used, res); // ç»§ç»­ dfsï¼Œdepth + 1
            // å›æº¯
            path.removeLast(); // ç§»é™¤è¢«ä½¿ç”¨è¿‡çš„å…ƒç´ 
            used[i] = false; // æ ‡è®°æ²¡æœ‰ä½¿ç”¨è¯¥å…ƒç´ 
        }
    }

    public static void main(String[] args) {
        int[] nums = {1, 2, 3, 4};
        cmbApp cmbApp = new cmbApp();
        List<List<Integer>> lists = cmbApp.getThreeNums(nums, 3);
        for (List<Integer> list : lists) {
            System.out.println(list);
        }
    }
}
```



---

#### [17. ç”µè¯å·ç çš„å­—æ¯ç»„åˆ](https://leetcode-cn.com/problems/letter-combinations-of-a-phone-number/)

> ç»™å®šä¸€ä¸ªä»…åŒ…å«æ•°å­— `2-9` çš„å­—ç¬¦ä¸²ï¼Œè¿”å›æ‰€æœ‰å®ƒèƒ½è¡¨ç¤ºçš„å­—æ¯ç»„åˆã€‚
>
> ç»™å‡ºæ•°å­—åˆ°å­—æ¯çš„æ˜ å°„å¦‚ä¸‹ï¼ˆä¸ç”µè¯æŒ‰é”®ç›¸åŒï¼‰ã€‚æ³¨æ„ 1 ä¸å¯¹åº”ä»»ä½•å­—æ¯ã€‚
>
> ![](https://assets.ryantech.ltd/20201018201525.png)
>
> ```
> è¾“å…¥ï¼š"23"
> è¾“å‡ºï¼š["ad", "ae", "af", "bd", "be", "bf", "cd", "ce", "cf"].
> ```

å…¨æ’åˆ—é—®é¢˜ï¼Œå¼•å…¥ HashMap ä½œä¸ºæ˜ å°„ã€‚



```java
// å…¨æ’åˆ—é—®é¢˜
public List<String> letterCombinations(String digits) {
    List<String> res = new ArrayList<>();

    if (digits == null || digits.length() == 0) {
        return res;
    }

    int len = digits.length();
    Deque<Character> path = new ArrayDeque<>();
    Map<Integer, char[]> map = new HashMap<>();
    map.put(2, new char[]{'a', 'b', 'c'});
    map.put(3, new char[]{'d', 'e', 'f'});
    map.put(4, new char[]{'g', 'h', 'i'});
    map.put(5, new char[]{'j', 'k', 'l'});
    map.put(6, new char[]{'m', 'n', 'o'});
    map.put(7, new char[]{'p', 'q', 'r', 's'});
    map.put(8, new char[]{'t', 'u', 'v'});
    map.put(9, new char[]{'w', 'x', 'y', 'z'});

    dfs(digits, len, 0, map, path, res);

    return res;
}

private void dfs(String digits, int len, int depth, Map<Integer, char[]> map, Deque<Character> path, List<String> res) {
    // é€’å½’ç»“æŸçš„æ¡ä»¶
    if (depth == len) {
        StringBuilder sb = new StringBuilder();
        for (char c : path) {
            sb.append(c);
        }
        res.add(sb.toString());
        return;
    }

    char digit = digits.charAt(depth);
    char[] chars = map.get(Integer.parseInt(String.valueOf(digit)));
    // å…¨æ’åˆ—
    for (char aChar : chars) {
        path.addLast(aChar);
        dfs(digits, len, depth + 1, map, path, res);
        path.removeLast();
    }
}
```



---

