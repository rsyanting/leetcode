# å•è°ƒæ ˆé—®é¢˜

---

ğŸ“—difficultyï¼š**Easy**	,	**Medium**	,	**Hard**

ğŸ¯Tagsï¼š

+ **[æ ˆ](https://leetcode-cn.com/tag/stack/)** 
---

## 1. é¢˜ç›®æè¿°ğŸ“ƒ

####  [739. æ¯æ—¥æ¸©åº¦](https://leetcode-cn.com/problems/daily-temperatures/)

è¯·æ ¹æ®æ¯æ—¥ æ°”æ¸© åˆ—è¡¨ï¼Œé‡æ–°ç”Ÿæˆä¸€ä¸ªåˆ—è¡¨ã€‚å¯¹åº”ä½ç½®çš„è¾“å‡ºä¸ºï¼šè¦æƒ³è§‚æµ‹åˆ°æ›´é«˜çš„æ°”æ¸©ï¼Œè‡³å°‘éœ€è¦ç­‰å¾…çš„å¤©æ•°ã€‚å¦‚æœæ°”æ¸©åœ¨è¿™ä¹‹åéƒ½ä¸ä¼šå‡é«˜ï¼Œè¯·åœ¨è¯¥ä½ç½®ç”¨ `0` æ¥ä»£æ›¿ã€‚

ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ªåˆ—è¡¨ `temperatures = [73, 74, 75, 71, 69, 72, 76, 73]`ï¼Œä½ çš„è¾“å‡ºåº”è¯¥æ˜¯ `[1, 1, 4, 2, 1, 1, 0, 0]`ã€‚

+ **æç¤ºï¼š**
    + æ°”æ¸© åˆ—è¡¨é•¿åº¦çš„èŒƒå›´æ˜¯ `[1, 30000] `ã€‚æ¯ä¸ªæ°”æ¸©çš„å€¼çš„å‡ä¸ºåæ°åº¦ï¼Œéƒ½æ˜¯åœ¨ `[30, 100]` èŒƒå›´å†…çš„æ•´æ•°ã€‚



---

## 2. è§£é¢˜æ€è·¯ğŸ’¡

### æš´åŠ›è§£æ³•

å¯¹æ¯ä¸€å¤©çš„æ¸©åº¦ï¼Œéƒ½å‘åè¿›è¡Œå¯»æ‰¾ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¸©åº¦é«˜äºçš„é‚£ä¸€å¤©æ—¶ï¼Œæ›´æ–° `res` çš„å€¼ã€‚



#### ä»£ç å®ç°

```java
// æš´åŠ›è§£æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ O(n ^ 2)
public int[] dailyTemperatures(int[] T) {
    int[] res = new int[T.length];
    int len = T.length;
    for (int i = 0; i < len; i++) {
        for (int j = i; j < len; j++) {
            if (T[j] > T[i]) {
                res[i] = j - i;
                break;
            }
        }
    }
    return res;
}
```



#### å¤æ‚åº¦åˆ†æ

+ æ—¶é—´å¤æ‚åº¦ï¼š`O(n ^ 2)`ã€‚
+ ç©ºé—´å¤æ‚åº¦ï¼š`O(1)` ã€‚ä¸è®¡ç®—æœ€åå­˜å‚¨ç»“æœçš„ç©ºé—´ï¼Œæ‰€éœ€ç©ºé—´æ˜¯ `O(1)` ã€‚

---

### ä¼˜åŒ–ç‰ˆ æš´åŠ›è§£æ³•

> [æ¯æ—¥æ¸©åº¦](https://leetcode-cn.com/problems/daily-temperatures/solution/mei-ri-wen-du-by-leetcode-solution/) Leetcode-cn é¢˜è§£

å¯¹äºæ¸©åº¦åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´  `T[i]`ï¼Œéœ€è¦æ‰¾åˆ°æœ€å°çš„ä¸‹æ ‡ `j`ï¼Œä½¿å¾— `i < j` ä¸” `T[i] < T[j]`ã€‚

ç”±äºæ¸©åº¦èŒƒå›´åœ¨ `[30, 100]` ä¹‹å†…ï¼Œå› æ­¤å¯ä»¥ç»´æŠ¤ä¸€ä¸ªæ•°ç»„ `next` è®°å½•æ¯ä¸ªæ¸©åº¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä¸‹æ ‡ã€‚æ•°ç»„ `next` ä¸­çš„å…ƒç´ åˆå§‹åŒ–ä¸ºæ— ç©·å¤§ï¼Œåœ¨éå†æ¸©åº¦åˆ—è¡¨çš„è¿‡ç¨‹ä¸­æ›´æ–° `next` çš„å€¼ã€‚

åå‘éå†æ¸©åº¦åˆ—è¡¨ã€‚å¯¹äºæ¯ä¸ªå…ƒç´  `T[i]`ï¼Œåœ¨æ•°ç»„ `next` ä¸­æ‰¾åˆ°ä» `T[i] + 1` åˆ° `100` ä¸­æ¯ä¸ªæ¸©åº¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä¸‹æ ‡ï¼Œå°†å…¶ä¸­çš„æœ€å°ä¸‹æ ‡è®°ä¸º `warmerIndex`ï¼Œåˆ™ `warmerIndex` ä¸ºä¸‹ä¸€æ¬¡æ¸©åº¦æ¯”å½“å¤©é«˜çš„ä¸‹æ ‡ã€‚å¦‚æœ `warmerIndex` ä¸ä¸ºæ— ç©·å¤§ï¼Œåˆ™ `warmerIndex - i` å³ä¸ºä¸‹ä¸€æ¬¡æ¸©åº¦æ¯”å½“å¤©é«˜çš„ç­‰å¾…å¤©æ•°ï¼Œæœ€åä»¤ `next[T[i]] = i` ã€‚

ä¸ºä»€ä¹ˆä¸Šè¿°åšæ³•å¯ä»¥ä¿è¯æ­£ç¡®å‘¢ï¼Ÿå› ä¸ºéå†æ¸©åº¦åˆ—è¡¨çš„æ–¹å‘æ˜¯åå‘ï¼Œå½“éå†åˆ°å…ƒç´  `T[i]` æ—¶ï¼Œåªæœ‰ `T[i]` åé¢çš„å…ƒç´ è¢«è®¿é—®è¿‡ï¼Œå³å¯¹äºä»»æ„ `t`ï¼Œå½“ `next[t]` ä¸ä¸ºæ— ç©·å¤§æ—¶ï¼Œä¸€å®šå­˜åœ¨ `j` ä½¿å¾— `T[j] == t ä¸” i < j` ã€‚åˆç”±äºéå†åˆ°æ¸©åº¦åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ—¶éƒ½ä¼šæ›´æ–°æ•°ç»„ `next` ä¸­çš„å¯¹åº”æ¸©åº¦çš„å…ƒç´ å€¼ï¼Œå› æ­¤å¯¹äºä»»æ„ `t`ï¼Œå½“ `next[t]` ä¸ä¸ºæ— ç©·å¤§æ—¶ï¼Œä»¤ `j = next[t]`ï¼Œåˆ™ `j` æ˜¯æ»¡è¶³ `T[j] == t ä¸” i < j` çš„æœ€å°ä¸‹æ ‡ã€‚



```java
// æš´åŠ›è§£æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ O(n * m)
public int[] dailyTemperatures(int[] T) {
    int length = T.length;
    int[] ans = new int[length];
    int[] next = new int[101];
    Arrays.fill(next, Integer.MAX_VALUE);
    // åå‘éå† æ°”æ¸© æ•°ç»„
    for (int i = length - 1; i >= 0; --i) {
        int warmerIndex = Integer.MAX_VALUE;
        for (int t = T[i] + 1; t <= 100; ++t) {
            if (next[t] < warmerIndex) {
                warmerIndex = next[t];
            }
        }
        if (warmerIndex < Integer.MAX_VALUE) {
            ans[i] = warmerIndex - i;
        }
        next[T[i]] = i;
    }
    return ans;
}
```



#### å¤æ‚åº¦åˆ†æ

+ æ—¶é—´å¤æ‚åº¦ï¼š`O(nm)`ï¼Œå…¶ä¸­ `n` æ˜¯æ¸©åº¦åˆ—è¡¨çš„é•¿åº¦ï¼Œ`m` æ˜¯æ•°ç»„ `next` çš„é•¿åº¦ï¼Œåœ¨æœ¬é¢˜ä¸­æ¸©åº¦ä¸è¶…è¿‡ `100`ï¼Œæ‰€ä»¥ `m` çš„å€¼ä¸º `100`ã€‚åå‘éå†æ¸©åº¦åˆ—è¡¨ä¸€éï¼Œå¯¹äºæ¸©åº¦åˆ—è¡¨ä¸­çš„æ¯ä¸ªå€¼ï¼Œéƒ½è¦éå†æ•°ç»„ `next` ä¸€éã€‚
+ ç©ºé—´å¤æ‚åº¦ï¼š`O(m)`ï¼Œå…¶ä¸­ `m` æ˜¯æ•°ç»„ `next` çš„é•¿åº¦ã€‚é™¤äº†è¿”å›å€¼ä»¥å¤–ï¼Œéœ€è¦ç»´æŠ¤é•¿åº¦ä¸º `m` çš„æ•°ç»„ `next` è®°å½•æ¯ä¸ªæ¸©åº¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä¸‹æ ‡ä½ç½®ã€‚

---

### å•è°ƒæ ˆæ³•

å¯ä»¥ç»´æŠ¤ä¸€ä¸ªå­˜å‚¨ä¸‹æ ‡çš„å•è°ƒæ ˆï¼Œä»æ ˆåº•åˆ°æ ˆé¡¶çš„ä¸‹æ ‡å¯¹åº”çš„æ¸©åº¦åˆ—è¡¨ä¸­çš„æ¸©åº¦ä¾æ¬¡é€’å‡ã€‚å¦‚æœä¸€ä¸ªä¸‹æ ‡åœ¨å•è°ƒæ ˆé‡Œï¼Œåˆ™è¡¨ç¤ºå°šæœªæ‰¾åˆ°ä¸‹ä¸€æ¬¡æ¸©åº¦æ›´é«˜çš„ä¸‹æ ‡ã€‚

æ­£å‘éå†æ¸©åº¦åˆ—è¡¨ã€‚å¯¹äºæ¸©åº¦åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´  `T[i]`ï¼Œå¦‚æœæ ˆä¸ºç©ºï¼Œåˆ™ç›´æ¥å°† `i` è¿›æ ˆï¼Œå¦‚æœæ ˆä¸ä¸ºç©ºï¼Œåˆ™æ¯”è¾ƒæ ˆé¡¶å…ƒç´  `prevIndex` å¯¹åº”çš„æ¸©åº¦ `T[prevIndex]` å’Œå½“å‰æ¸©åº¦ `T[i]`ï¼Œå¦‚æœ `T[i] > T[prevIndex]`ï¼Œåˆ™å°† `prevIndex` ç§»é™¤ï¼Œå¹¶å°† `prevIndex` å¯¹åº”çš„ **ç­‰å¾…å¤©æ•°** èµ‹ä¸º `i - prevIndex`ï¼Œé‡å¤ä¸Šè¿°æ“ä½œç›´åˆ°æ ˆä¸ºç©ºæˆ–è€…æ ˆé¡¶å…ƒç´ å¯¹åº”çš„æ¸©åº¦å°äºç­‰äºå½“å‰æ¸©åº¦ï¼Œç„¶åå°† `i` è¿›æ ˆã€‚

ä¸ºä»€ä¹ˆå¯ä»¥åœ¨å¼¹æ ˆçš„æ—¶å€™æ›´æ–° `res[prevIndex]` å‘¢ï¼Ÿå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå³å°†è¿›æ ˆçš„ `i` å¯¹åº”çš„ `T[i]` ä¸€å®šæ˜¯ `T[prevIndex]` å³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå¤§çš„å…ƒç´ ï¼Œè¯•æƒ³å¦‚æœ `prevIndex` å’Œ `i` æœ‰æ¯”å®ƒå¤§çš„å…ƒç´ ï¼Œå‡è®¾ä¸‹æ ‡ä¸º `j`ï¼Œé‚£ä¹ˆ `prevIndex` ä¸€å®šä¼šåœ¨ä¸‹æ ‡ `j` çš„é‚£ä¸€è½®è¢«å¼¹æ‰ã€‚

ç”±äºå•è°ƒæ ˆæ»¡è¶³ä»æ ˆåº•åˆ°æ ˆé¡¶å…ƒç´ å¯¹åº”çš„æ¸©åº¦é€’å‡ï¼Œå› æ­¤æ¯æ¬¡æœ‰å…ƒç´ è¿›æ ˆæ—¶ï¼Œä¼šå°†æ¸©åº¦æ›´ä½çš„å…ƒç´ å…¨éƒ¨ç§»é™¤ï¼Œå¹¶æ›´æ–°å‡ºæ ˆå…ƒç´ å¯¹åº”çš„ç­‰å¾…å¤©æ•°ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ç­‰å¾…å¤©æ•°ä¸€å®šæ˜¯æœ€å°çš„ã€‚



```java
// å•è°ƒæ ˆ è§£æ³•
// æ—¶é—´å¤æ‚åº¦ O(n) ï¼Œæ¯ä¸ªå…ƒç´ æœ€å¤šæœ‰ 1 æ¬¡è¿›æ ˆå’Œå‡ºæ ˆçš„æœºä¼š
public int[] dailyTemperatures(int[] T) {
    int[] res = new int[T.length];
    int len = T.length;
    Deque<Integer> stack = new LinkedList<>();

    for (int i = 0; i < len; i++) {
        int t = T[i];
        while (!stack.isEmpty() && t > T[stack.peekLast()]) {
            int prevIndex = stack.pollLast();
            res[prevIndex] = i - prevIndex;
        }
        stack.offerLast(i); // æ ˆä¸­å­˜å‚¨çš„æ˜¯ index ä¸‹æ ‡
    }
    return res;
}
```

#### å¤æ‚åº¦åˆ†æ

+ æ—¶é—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯æ¸©åº¦åˆ—è¡¨çš„é•¿åº¦ã€‚æ­£å‘éå†æ¸©åº¦åˆ—è¡¨ä¸€éï¼Œå¯¹äºæ¸©åº¦åˆ—è¡¨ä¸­çš„æ¯ä¸ªä¸‹æ ‡ï¼Œæœ€å¤šæœ‰ä¸€æ¬¡è¿›æ ˆå’Œå‡ºæ ˆçš„æ“ä½œã€‚
+ ç©ºé—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯æ¸©åº¦åˆ—è¡¨çš„é•¿åº¦ã€‚éœ€è¦ç»´æŠ¤ä¸€ä¸ªå•è°ƒæ ˆå­˜å‚¨æ¸©åº¦åˆ—è¡¨ä¸­çš„ä¸‹æ ‡ã€‚



---

## 3. æ€»ç»“ğŸ¯

### ç›¸ä¼¼é—®é¢˜

#### [496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I](https://leetcode-cn.com/problems/next-greater-element-i/)

> ç»™å®šä¸¤ä¸ª æ²¡æœ‰é‡å¤å…ƒç´  çš„æ•°ç»„ nums1 å’Œ nums2 ï¼Œå…¶ä¸­nums1 æ˜¯ nums2 çš„å­é›†ã€‚æ‰¾åˆ° nums1 ä¸­æ¯ä¸ªå…ƒç´ åœ¨ nums2 ä¸­çš„ä¸‹ä¸€ä¸ªæ¯”å…¶å¤§çš„å€¼ã€‚
>
> nums1 ä¸­æ•°å­— x çš„ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ æ˜¯æŒ‡ x åœ¨ nums2 ä¸­å¯¹åº”ä½ç½®çš„å³è¾¹çš„ç¬¬ä¸€ä¸ªæ¯” x å¤§çš„å…ƒç´ ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œå¯¹åº”ä½ç½®è¾“å‡º -1 ã€‚
>
> 
>
> è¾“å…¥: nums1 = [4,1,2], nums2 = [1,3,4,2].
> è¾“å‡º: [-1,3,-1]
> è§£é‡Š:
>     å¯¹äºnum1ä¸­çš„æ•°å­—4ï¼Œä½ æ— æ³•åœ¨ç¬¬äºŒä¸ªæ•°ç»„ä¸­æ‰¾åˆ°ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°å­—ï¼Œå› æ­¤è¾“å‡º -1ã€‚
>     å¯¹äºnum1ä¸­çš„æ•°å­—1ï¼Œç¬¬äºŒä¸ªæ•°ç»„ä¸­æ•°å­—1å³è¾¹çš„ä¸‹ä¸€ä¸ªè¾ƒå¤§æ•°å­—æ˜¯ 3ã€‚
>     å¯¹äºnum1ä¸­çš„æ•°å­—2ï¼Œç¬¬äºŒä¸ªæ•°ç»„ä¸­æ²¡æœ‰ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°å­—ï¼Œå› æ­¤è¾“å‡º -1ã€‚



> é¢˜è§£ ï¼š [å•è°ƒæ ˆè§£å†³ Next Greater Number ä¸€ç±»é—®é¢˜](https://leetcode-cn.com/problems/next-greater-element-i/solution/dan-diao-zhan-jie-jue-next-greater-number-yi-lei-w/) 



![å›¾è§£](https://assets.ryantech.ltd/20201013211911.png)



`for` å¾ªç¯è¦ä»åå¾€å‰æ‰«æå…ƒç´ ï¼Œå› ä¸ºæˆ‘ä»¬å€ŸåŠ©çš„æ˜¯æ ˆçš„ç»“æ„ï¼Œå€’ç€å…¥æ ˆï¼Œå…¶å®æ˜¯æ­£ç€å‡ºæ ˆã€‚`while` å¾ªç¯æ˜¯æŠŠä¸¤ä¸ªâ€œé«˜ä¸ªâ€å…ƒç´ ä¹‹é—´çš„å…ƒç´ æ’é™¤ï¼Œå› ä¸ºä»–ä»¬çš„å­˜åœ¨æ²¡æœ‰æ„ä¹‰ï¼Œå‰é¢æŒ¡ç€ä¸ªâ€œæ›´é«˜â€çš„å…ƒç´ ï¼Œæ‰€ä»¥ä»–ä»¬ä¸å¯èƒ½è¢«ä½œä¸ºåç»­è¿›æ¥çš„å…ƒç´ çš„ Next Great Number äº†ã€‚



```java
// å•è°ƒæ ˆ æ³•
public int[] nextGreaterElement(int[] nums1, int[] nums2) {
    int[] res = new int[nums1.length];
    Arrays.fill(res, -1);
    Map<Integer, Integer> map = new HashMap<>(); // ä½¿å¾—æŸ¥æ‰¾é€Ÿåº¦æ›´å¿«
    Deque<Integer> stack = new LinkedList<>();

    for (int i = nums2.length - 1; i >= 0; i--) { // å°†æ•°å­—å€’ç€å…¥æ ˆ
        int t = nums2[i];
        while (!stack.isEmpty() && stack.peekLast() <= t) { // åˆ¤å®šæ•°å­—çš„å¤§å°
            stack.pollLast(); // å‘ç°å½“å‰æ ˆé¡¶å…ƒç´ å°ï¼Œé‚£ä¹ˆå¼¹å‡º
        }
        map.put(t, stack.isEmpty() ? -1 : stack.peekLast()); // t åçš„ç¬¬ä¸€ä¸ªå¤§äºå®ƒçš„æ•°
        stack.offerLast(t);
    }

    for (int i = 0; i < nums1.length; i++) {
        res[i] = map.get(nums1[i]);
    }
    return res;
}
```

##### å¤æ‚åº¦åˆ†æ

+ æ—¶é—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯åˆ—è¡¨çš„é•¿åº¦ã€‚é€†å‘éå†åˆ—è¡¨ä¸€éï¼Œå¯¹äºåˆ—è¡¨ä¸­çš„æ¯ä¸ªä¸‹æ ‡ï¼Œæœ€å¤šæœ‰ä¸€æ¬¡è¿›æ ˆå’Œå‡ºæ ˆçš„æ“ä½œã€‚
+ ç©ºé—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯åˆ—è¡¨çš„é•¿åº¦ã€‚éœ€è¦ç»´æŠ¤ä¸€ä¸ªå•è°ƒæ ˆå­˜å‚¨åˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚ä»¥åŠä¸€ä¸ªå“ˆå¸Œè¡¨ï¼ŒåŠ å¿«æŸ¥è¯¢çš„é€Ÿåº¦ã€‚



---

#### [503. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II](https://leetcode-cn.com/problems/next-greater-element-ii/)

å›åˆ° Next Greater Number çš„é—®é¢˜ï¼Œå¢åŠ äº†ç¯å½¢å±æ€§åï¼Œé—®é¢˜çš„éš¾ç‚¹åœ¨äºï¼šè¿™ä¸ª Next çš„æ„ä¹‰ä¸ä»…ä»…æ˜¯å½“å‰å…ƒç´ çš„å³è¾¹äº†ï¼Œæœ‰å¯èƒ½å‡ºç°åœ¨å½“å‰å…ƒç´ çš„å·¦è¾¹ï¼ˆå¦‚ä¸Šä¾‹ï¼‰ã€‚

æ˜ç¡®é—®é¢˜ï¼Œé—®é¢˜å°±å·²ç»è§£å†³äº†ä¸€åŠäº†ã€‚æˆ‘ä»¬å¯ä»¥è€ƒè™‘è¿™æ ·çš„æ€è·¯ï¼šå°†åŸå§‹æ•°ç»„â€œç¿»å€â€ï¼Œå°±æ˜¯åœ¨åé¢å†æ¥ä¸€ä¸ªåŸå§‹æ•°ç»„ï¼Œè¿™æ ·çš„è¯ï¼ŒæŒ‰ç…§ä¹‹å‰â€œæ¯”èº«é«˜â€çš„æµç¨‹ï¼Œæ¯ä¸ªå…ƒç´ ä¸ä»…å¯ä»¥æ¯”è¾ƒè‡ªå·±å³è¾¹çš„å…ƒç´ ï¼Œè€Œä¸”ä¹Ÿå¯ä»¥å’Œå·¦è¾¹çš„å…ƒç´ æ¯”è¾ƒäº†ã€‚

![å›¾è§£](https://assets.ryantech.ltd/20201013212201.png)

è€Œæ¨¡æ‹Ÿæ•°ç»„çš„ç¿»å€ï¼Œå¯ä»¥ä½¿ç”¨æ‰©å®¹ä¸‹æ ‡å†å–æ¨¡çš„æ“ä½œã€‚

```java
public int[] nextGreaterElements(int[] nums) {
    Deque<Integer> stack = new LinkedList<>();
    int len = nums.length;
    int[] res = new int[len];
    for (int i = len * 2 - 1; i >= 0; i--) { // å€’ç€å¾€æ ˆé‡Œæ”¾
        int t = nums[i % len];
        while (!stack.isEmpty() && stack.peekLast() <= t) { // åˆ¤å®šä¸ªå­é«˜çŸ®
            stack.pollLast(); // // çŸ®ä¸ªèµ·å¼€ï¼Œåæ­£ä¹Ÿè¢«æŒ¡ç€äº†...
        }
        res[i % len] = stack.isEmpty() ? -1 : stack.peekLast(); // è¿™ä¸ªå…ƒç´ èº«åçš„ç¬¬ä¸€ä¸ªé«˜ä¸ª
        stack.offerLast(nums[i % len]); // è¿›æ ˆï¼Œæ¥å—ä¹‹åçš„èº«é«˜åˆ¤å®š
    }

    return res;
}
```

##### å¤æ‚åº¦åˆ†æ

+ æ—¶é—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯åˆ—è¡¨çš„é•¿åº¦ã€‚é€†å‘éå†åˆ—è¡¨ä¸€éï¼Œå¯¹äºåˆ—è¡¨ä¸­çš„æ¯ä¸ªä¸‹æ ‡ï¼Œæœ€å¤šæœ‰ä¸€æ¬¡è¿›æ ˆå’Œå‡ºæ ˆçš„æ“ä½œã€‚
+ ç©ºé—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯åˆ—è¡¨çš„é•¿åº¦ã€‚éœ€è¦ç»´æŠ¤ä¸€ä¸ªå•è°ƒæ ˆå­˜å‚¨åˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚

---

#### [901. è‚¡ç¥¨ä»·æ ¼è·¨åº¦](https://leetcode-cn.com/problems/online-stock-span/)

> é¢˜è§£ ï¼š [è‚¡ç¥¨ä»·æ ¼è·¨åº¦](https://leetcode-cn.com/problems/online-stock-span/solution/gu-piao-jie-ge-kua-du-by-leetcode/)

è®¾ç½® 2 ä¸ªæ ˆï¼Œä¸€ä¸ªç”¨äºå­˜å‚¨ `price`ï¼Œä¸€ä¸ªå­˜å‚¨å¯¹åº”çš„ `price` çš„ä»·æ ¼è·¨åº¦ã€‚

ä¸æ–­çš„åˆ¤æ–­æ ˆé¡¶å…ƒç´ å’Œå½“å‰å…ƒç´ çš„å€¼ï¼Œå°†å°äºå½“å‰ `price`  çš„ä»·æ ¼å…¨éƒ¨å¼¹å‡ºï¼Œå¹¶ä¸”æ›´æ–° `ans` çš„å€¼å’Œå­˜å‚¨ä»·æ ¼è·¨åº¦çš„æ ˆ `indexes` ã€‚



```java
import java.util.ArrayList;
import java.util.Deque;
import java.util.LinkedList;
import java.util.List;

/**
 * @description 901. è‚¡ç¥¨ä»·æ ¼è·¨åº¦
 * @leetcode_CN_url // https://leetcode-cn.com/problems/online-stock-span/
 * @hard_level Medium
 * @tag Stack // https://leetcode-cn.com/tag/stack/
 * @create 2020/10/13 21:35
 **/

public class StockSpanner {
    Deque<Integer> indexes;
    Deque<Integer> prices;

    public StockSpanner() {
        this.indexes = new LinkedList<>();
        this.prices = new LinkedList<>();
    }

    public int next(int price) {
        int ans = 1;
        while (!this.prices.isEmpty() && this.prices.peekLast() <= price) {
            this.prices.pollLast();
            ans += this.indexes.isEmpty() ? 0 : this.indexes.pollLast(); // å®é™…ä¸Šè¿™é‡Œä¸ä¼šå‡ºç°åŠ  0 çš„æƒ…å†µ
        }
        this.indexes.offerLast(ans);
        this.prices.offerLast(price);
        return ans;
    }

    public static void main(String[] args) {
        StockSpanner stockSpanner = new StockSpanner();
        System.out.println(stockSpanner.next(100));
        System.out.println(stockSpanner.next(80));
        System.out.println(stockSpanner.next(60));
        System.out.println(stockSpanner.next(70));
        System.out.println(stockSpanner.next(60));
        System.out.println(stockSpanner.next(75));
        System.out.println(stockSpanner.next(85));
    }
}
```



##### å¤æ‚åº¦åˆ†æ

+ æ—¶é—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯åˆ—è¡¨çš„é•¿åº¦ã€‚é€†å‘éå†åˆ—è¡¨ä¸€éï¼Œå¯¹äºåˆ—è¡¨ä¸­çš„æ¯ä¸ªä¸‹æ ‡ï¼Œæœ€å¤šæœ‰ä¸€æ¬¡è¿›æ ˆå’Œå‡ºæ ˆçš„æ“ä½œã€‚
+ ç©ºé—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯åˆ—è¡¨çš„é•¿åº¦ã€‚éœ€è¦ç»´æŠ¤ä¸€ä¸ªå•è°ƒæ ˆå­˜å‚¨åˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚



---

#### [84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](https://leetcode-cn.com/problems/largest-rectangle-in-histogram/)

> [é¢˜è§£ ï¼š æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](https://leetcode-cn.com/problems/largest-rectangle-in-histogram/solution/zhu-zhuang-tu-zhong-zui-da-de-ju-xing-by-leetcode-/)

![](https://assets.ryantech.ltd/20201015154341.png)

å¯¹äºä¸Šå›¾ï¼Œå›¾ä¸­é˜´å½±éƒ¨åˆ†å‹¾å‹’å‡ºæ¥çš„éƒ¨åˆ†ï¼Œä¸ºæœ€å¤§çš„çŸ©å½¢é¢ç§¯ï¼Œé¢ç§¯æœ€å¤§ä¸º `10` ã€‚



##### æš´åŠ›è§£æ³•

æ ¹æ®é¢˜ç›®çš„æè¿°ï¼Œé¦–å…ˆä½¿ç”¨ç›´è§‚çš„æ€è·¯å»å°è¯•æ±‚è§£ï¼Œå³æš´åŠ›æ±‚è§£ã€‚

å¯¹äºæ¯ä¸€ä¸ªçŸ©å½¢ï¼Œå‘å·¦å‘å³çœ‹ï¼Œæ‰¾åˆ°å…¶èƒ½å‘å·¦å‘å³å»¶ç”³çš„æœ€è¿œä½ç½®ï¼Œä¾‹å¦‚å¯¹äº `heights[1] = 1`ï¼Œå…¶å‘å·¦æœ€è¿œå¯ä»¥å»¶å±•åˆ° ``heights[0]` ï¼Œå‘å³æœ€è¿œå¯ä»¥å»¶å±•åˆ° `heights[5]` ã€‚è¿™æ ·ï¼Œæ¯ä¸ªå…ƒç´ æœ€å¤šéœ€è¦éå†æ•´ä¸ªæ•°ç»„ï¼Œéœ€è¦åŒé‡çš„å¾ªç¯ï¼Œå…¶å¤æ‚åº¦ä¸º `O(n ^ 2)` ã€‚

è¿™æ ·é¦–å…ˆè§£å†³æ‰é—®é¢˜ï¼Œç„¶åå»å°è¯•å¯»æ‰¾ç‰¹æ®Šçš„è§„å¾‹ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ä»¥ç©ºé—´æ¢å–æ—¶é—´ï¼Œå°†æ—¶é—´å¤æ‚åº¦é™ä½ä¸‹æ¥ã€‚

```java
// æš´åŠ›è§£æ³•
public int largestRectangleArea(int[] heights) {
    int len = heights.length;
    if (len == 0) {
        return 0;
    }

    int res = 0;
    for (int i = 0; i < len; i++) {
        // å‘å·¦å¯»æ‰¾
        int left = i;
        int curHeight = heights[i];

        while (left > 0 && heights[left - 1] >= curHeight) {
            left--;
        }

        // å‘å³å¯»æ‰¾
        int right = i;
        while (right < (len - 1) && heights[right + 1] >= curHeight) {
            right++;
        }

        res = Math.max(res, (right - left + 1) * curHeight);
    }

    return res;
}
```

+ å¤æ‚åº¦åˆ†æ
    + æ—¶é—´å¤æ‚åº¦ï¼š`O(n ^ 2)`ï¼Œå…¶ä¸­ `n` æ˜¯åˆ—è¡¨çš„é•¿åº¦ã€‚æœ€åæƒ…å†µä¸‹ï¼Œ å¯¹äºæ¯ä¸€ä¸ªå…ƒç´ ï¼Œéƒ½éœ€è¦å‘å·¦å‘å³çœ‹åˆ°åº•ï¼Œå¤æ‚åº¦ä¸º `O(n ^ 2)` ã€‚
    + ç©ºé—´å¤æ‚åº¦ï¼š`O(1)` ã€‚æ²¡æœ‰ä½¿ç”¨é¢å¤–ç©ºé—´ã€‚



##### ä½¿ç”¨æ ˆä½œä¸ºè¾…åŠ©

å¦‚æœå¯ä»¥ä¸€è¾¹éå†ä¸€è¾¹å»è®°å½•ä¸€äº›ä¿¡æ¯ï¼Œèƒ½éå†ä¸€æ¬¡æ•°ç»„å°±å¯ä»¥æ±‚å‡ºç»“æœï¼Œå³å¯ä»¥é™ä½æ—¶é—´å¤æ‚åº¦ã€‚





```java
// ä½¿ç”¨æ ˆä½œä¸ºè¾…åŠ©
public int largestRectangleArea(int[] heights) {
    int len = heights.length;
    if (len == 0) {
        return 0;
    }

    if (len == 1) {
        return heights[0];
    }


    int area = 0;
    Deque<Integer> stack = new LinkedList<>();

    for (int i = 0; i < len; i++) {
        while (!stack.isEmpty() && heights[stack.peekLast()] > heights[i]) {
            int height = heights[stack.pollLast()];

            while (!stack.isEmpty() && heights[stack.peekLast()] == height) {
                stack.pollLast();
            }

            int width;
            if (stack.isEmpty()) {
                width = i;
            } else {
                width = i - stack.peekLast() - 1;
            }

            area = Math.max(area, width * height);
        }
        stack.offerLast(i);
    } // end of for

    while (!stack.isEmpty()) {
        int height = heights[stack.pollLast()];

        while (!stack.isEmpty() && heights[stack.peekLast()] == height) {
            stack.pollLast();
        }

        int width;
        if (stack.isEmpty()) {
            width = len;
        } else {
            width = len - stack.peekLast() - 1;
        }

        area = Math.max(area, width * height);
    }

    return area;
}
```

+ å¤æ‚åº¦åˆ†æ
    + æ—¶é—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚
    + ç©ºé—´å¤æ‚åº¦ï¼š`O(n)` ã€‚ä½¿ç”¨é¢å¤–çš„ä¸€ä¸ªè¾…åŠ©æ ˆã€‚

##### å“¨å…µæ€æƒ³ + æ ˆè¾…åŠ©



```java
// å“¨å…µæ€æƒ³
// ä½¿ç”¨æ ˆä½œä¸ºè¾…åŠ©
public int largestRectangleArea(int[] heights) {
    int len = heights.length;
    if (len == 0) {
        return 0;
    }

    if (len == 1) {
        return heights[0];
    }


    int area = 0;
    // æ–°æ•°ç»„çš„ å¤´éƒ¨ å’Œ å°¾éƒ¨ï¼Œå…ƒç´ å‡è®¾ç½®ä¸º 0
    int[] newHeight = new int[len + 2];
    System.arraycopy(heights, 0, newHeight, 1, len);
    len += 2;
    heights = newHeight;

    Deque<Integer> stack = new ArrayDeque<>();
    stack.offerLast(0);

    for (int i = 1; i < len; i++) {
        while (!stack.isEmpty() && heights[stack.peekLast()] > heights[i]) {
            int height = heights[stack.pollLast()];
            int width = i - stack.peekLast() - 1; // æ ˆéç©º
            area = Math.max(area, width * height);
        }
        stack.offerLast(i);
    }
    return area;
}
```



å¤æ‚åº¦åˆ†æ

+ æ—¶é—´å¤æ‚åº¦ï¼š`O(n)`ï¼Œå…¶ä¸­ `n` æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚
+ ç©ºé—´å¤æ‚åº¦ï¼š`O(n)` ã€‚ä½¿ç”¨é¢å¤–çš„ä¸€ä¸ªè¾…åŠ©æ ˆï¼Œå’Œä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå¤§å°ä¸º `nums.length + 2` ã€‚



---







